<!doctype html>
<html>
    <head>
        <meta charset="utf-8">
        <title>Index</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link rel="shortcut icon" href="css/img/fav-icon.png" />

        <link rel="stylesheet" type="text/css" href="css/font-awesome/css/font-awesome.min.css">
        <link href="https://fonts.googleapis.com/css?family=Cairo:200,300,400,600,700,900&amp;subset=arabic" rel="stylesheet">

    	<!--<link rel="stylesheet" type="text/css" href="css/bootstrap.min.css"/>
        <link rel="stylesheet" type="text/css" href="css/bootstrap-rtl.min.css"/>-->
        <link rel="stylesheet" type="text/css" href="css/mobile.css" media="all"/>
        <link rel="stylesheet" type="text/css" href="css/white-style.css" media="all"/>
    </head>
    <body>
    	<div class="mobile-body">
    	<header>
    		<div class="container-mobile">
    			<div class="top-link">
    				<ul>
    					<li><a href="#">الجهات</a></li>
    					<li><a href="#">التصنيف</a></li>
    					<li><a href="#">الحالة</a></li>
    					<li><span class="icon-menu"><i class="fa fa-bars" aria-hidden="true"></i></span></li>
    				</ul>
    			</div><!--top-link-->
    		</div><!--container-mobile-->
    	</header>
    	
    	<div class="menu">
    		<ul>
    			<li><a href="#">الإجماليات</a></li>
    			<li><a href="#">المهام</a></li>
    			<li><a href="#">الإجراءات</a></li>
    			<li><a href="#">التسجيل</a></li>
    		</ul>
    	</div>
    	<main>
    		<div class="container-mobile no-padding main_content">
    			<div class="block">
    			
    			</div><!--block-->
    			<div class="guide">
    				<ul>
    					<li><span class="color" style="background: #92d050"></span><span>مهام منتهية</span></li>
    					<li><span class="color" style="background: #00b0f0"></span><span>مهام لم تبدأ بعد</span></li>
    					<li><span class="color" style="background: #ffff00"></span><span>مهام تحت الإجراء</span></li>
    					<li><span class="color" style="background: #ff6565"></span><span>مهام متأخرة</span></li>
    				</ul>
    			</div>
    		</div><!--container-mobile-->
    	</main>
    	<footer>
    		<div class="container-mobile">
    			<p>جميع الحقوق محفوظة لنظام تسجيل ومتابعة المهام الاستراتيجية 2017 ©</p>
    		</div>
    	</footer>
		</div><!--mobile-body-->
        <script type="text/javascript" src="js/jquery-2.1.3.min.js"></script>
        <script type="text/javascript" src="js/bootstrap.js"></script>
        <script>
			$(document).ready(function(){
				$(".icon-menu").click(function(){
					$(".menu").toggleClass("show-menu");
				});
			});
			
		
$(document).ready(function() {
  /*var url="http://app.madadrental.com/send-mail.php?name1="+name+"&email1="+email+"&car_id1="+car_id+"&message1="+message+"&contact1="+contact+"&pickup_location_id1="+pickup_location_id+"&pickup_date1="+pickup_date+"&pickup_time1="+pickup_time+"&dropoff_location_id1="+dropoff_location_id+"&dropoff_date1="+dropoff_date+"&dropoff_time1="+dropoff_time+"&body_type_id1="+body_type_id+"&fuel_type_id1="+fuel_type_id+"";*/
  
  
    var TskSuccessCount = 0 ;
		 var TskNotStartedCount = 0 ;
		 var TskProccessCount = 0 ;
		 var TskLateCount = 0 ;
  
  var url ="http://ws.evara.info/api/values/GetAllEntities";
  $.getJSON(url,function(result){ 
        //console.log(result);
 $.each(result, function(i , Ent){
	 
	   var url ="http://ws.evara.info/api/values/GetAllTasks";
  $.getJSON(url,function(result){ 
  
 TskSuccessCount = 0 ;
	TskNotStartedCount = 0 ;
	TskProccessCount = 0 ;
	TskLateCount = 0 ;
        //console.log(result);
 $.each(result, function(i , Tsk){
  
	 /*var Ent.ID = EntID ;
	 var Tsk.TypeEntityID = TskID ;*/
	 
	
	 if( Ent.ID == Tsk.TypeEntityID ){
		 
		 if(Tsk.TaskStatusID == 4) { TskSuccessCount++; }
		 if(Tsk.TaskStatusID == 3) { TskNotStartedCount++; }
		 if(Tsk.TaskStatusID == 2) { TskProccessCount++; }
		 if(Tsk.TaskStatusID == 1) { TskLateCount++; }
		 		 
	      }
		  
	  });
	  
	  //alert(TskSuccessCount);
	  
	  var AllTskCount = TskSuccessCount + TskNotStartedCount + TskProccessCount + TskLateCount  ;
	 
	 var TskSuccessPrcntg = (TskSuccessCount / AllTskCount) * 100  ;
	 var TskNotStartedPrcntg = (TskNotStartedCount / AllTskCount )  * 100 ;
	 var TskProccessPrcntg = (TskProccessCount / AllTskCount )  * 100  ;
	 var TskLatePrcntg = (TskLateCount / AllTskCount )  * 100 ;
	 
	 if( TskSuccessCount == 0) { TskSuccessPrcntg = 1 };
	 if( TskNotStartedCount == 0) { TskNotStartedPrcntg = 1 };
	 if( TskProccessCount == 0) { TskProccessPrcntg = 1 };
	 if( TskLateCount == 0) { TskLatePrcntg = 1 };
	 
	 
$(".main_content").append('<div class="col-6"><div class="item-container"><div class="item-title"><span>'+Ent.Name+'<span class="num">'+AllTskCount+'</span></div><!--item-title--><div class="chart"><ul><li class="task_success"><p style="height: '+TskSuccessPrcntg+'%"><span>'+TskSuccessCount+'</span></p></li><li class="task_no_started"><p style="height: '+TskNotStartedPrcntg+'%"><span>'+TskNotStartedCount+'</span></p></li><li class="task_inprogress"><p style="height: '+TskProccessPrcntg+'%"><span>'+TskProccessCount+'</span></p></li><li class="task_late"><p style="height: '+TskLatePrcntg+'%"><span>'+TskLateCount+'</span></p></li></ul></div><!--chart--></div></div><!--col-6-->');
	
	
	
 

}); 
 
 
 });
 
});
});

			
		</script>

    </body>
</html>
