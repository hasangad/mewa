<!doctype html>
<html>
    <head>
        <meta charset="utf-8">
        <title>Index</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link rel="shortcut icon" href="" />

        <link rel="stylesheet" type="text/css" href="css/font-awesome/css/font-awesome.min.css">
        <link href="https://fonts.googleapis.com/css?family=Cairo:200,300,400,600,700,900&amp;subset=arabic" rel="stylesheet">

    	<!--<link rel="stylesheet" type="text/css" href="css/bootstrap.min.css"/>
        <link rel="stylesheet" type="text/css" href="css/bootstrap-rtl.min.css"/>-->
        <link rel="stylesheet" type="text/css" href="css/mobile.css" media="all"/>
        <link rel="stylesheet" type="text/css" href="css/white-style.css" media="all"/>
    </head>
    <body>
    <div class="all_white"></div>
    <div class="loading_now" style="display:none;">
<b>جار تشفير وتحميل البيانات ...</b></div>
    
    <div class="container login_page">


            <form method="post" action="/Entites" id="form1" class="form-signin col-lg-5 col-lg-offset-3">
            
            <h1>نظام تسجيل ومتابعة المهام الاستراتيجية</h1>

            
   <fieldset class="col-lg-11">
                    <label for="inputName" class="col-lg-4 label">اسم الستخدم</label>
                    <input name="inputName" type="text" id="inputName" class="form-control col-lg-8" placeholder="اسم المستخدم" required autofocus>
                </fieldset>
                <br>
                <fieldset class="col-lg-11">
                    <label for="inputPassword" class="col-lg-4 label">كلمة المرور</label>
                    <input name="inputPassword" type="password" id="inputPassword" class="form-control col-lg-8" placeholder="كلمة المرور" required>
                </fieldset>
                
 <a href="#" class=" col-lg-8 col-lg-offset-4 no-padding">نسيت كلمة المرور أو اسم المستخدم ؟</a>
            </form>

        </div>
    
    	<div class="mobile-body">
    	<header>
    		<div class="container-mobile">
    			<div class="top-link">
    				<ul>
    					<li><a href="#" id="entities" class="ActiveLink">الجهات</a></li>
    					<li><a href="#" id="classification">التصنيف</a></li>
    					<li><a href="#">الحالة</a></li>
    					<li><span class="icon-menu"><i class="fa fa-bars" aria-hidden="true"></i></span></li>
    				</ul>
    			</div><!--top-link-->
    		</div><!--container-mobile-->
    	</header>
    	
    	<div class="menu">
    		<ul>
    			<li><a href="#">الإجماليات</a></li>
    			<li><a href="#">المهام</a></li>
    			<li><a href="#">الإجراءات</a></li>
    			<li><a href="#">التسجيل</a></li>
    		</ul>
    	</div>
    	<main>
    		<div class="container-mobile no-padding main_content">
    			<div class="block">
    			
    			</div><!--block-->
    			<div class="guide">
    				<ul>
    					<li id="task_success"><span class="color" style="background: #92d050"></span><span>مهام منتهية</span></li>
    					<li id="task_no_started"><span class="color" style="background: #00b0f0"></span><span>مهام لم تبدأ بعد</span></li>
    					<li id="task_inprogress"><span class="color" style="background: #ffff00"></span><span>مهام تحت الإجراء</span></li>
    					<li id="task_late"><span class="color" style="background: #ff6565"></span><span>مهام متأخرة</span></li>
    				</ul>
    			</div>
                <div class="entities">
                
                
                </div>
                
                <div class="classification" style="display:none">
                
                
                </div>
               
    		</div><!--container-mobile-->
    	</main>
    	<footer>
    		<div class="container-mobile">
    			<p>جميع الحقوق محفوظة لنظام تسجيل ومتابعة المهام الاستراتيجية 2017 ©</p>
    		</div>
    	</footer>
		</div><!--mobile-body-->
        <script type="text/javascript" src="js/jquery-2.1.3.min.js"></script>
        <script type="text/javascript" src="js/bootstrap.js"></script>
        <script>
			$(document).ready(function(){
				
				
				$(".icon-menu").click(function(){
					$(".menu").toggleClass("show-menu");
				});

	
	$(".all_white").fadeOut(500);

	$("#entities").click(function(){
		$(".classification").hide();
		$(".entities").show();
       $("#classification").removeClass('ActiveLink');
		$(this).addClass('ActiveLink')	});
	
	
	$("#classification").click(function(){
		$(".entities").hide();
		$(".classification").show();
		$("#entities").removeClass('ActiveLink');
		$(this).addClass('ActiveLink');
	});
	
	
	$("#inputPassword").keyup(function(e) {
		
        if( ($("#inputName").val() == "admin" ) && ( $('#inputPassword').val() == "123456")) { 
	
	//alert('بيانات الدخول صحيحة');
	//$(".loading_now").fadeIn();
	//$('.login_btn').removeAttr('disabled');
	setInterval(function(){
		 $('.login_page').fadeOut(); }, 700);
	
	
	
	
	} else { }
    });
	

  /*var url="http://app.madadrental.com/send-mail.php?name1="+name+"&email1="+email+"&car_id1="+car_id+"&message1="+message+"&contact1="+contact+"&pickup_location_id1="+pickup_location_id+"&pickup_date1="+pickup_date+"&pickup_time1="+pickup_time+"&dropoff_location_id1="+dropoff_location_id+"&dropoff_date1="+dropoff_date+"&dropoff_time1="+dropoff_time+"&body_type_id1="+body_type_id+"&fuel_type_id1="+fuel_type_id+"";*/
  
  
    var TskSuccessCount = 0 ;
		 var TskNotStartedCount = 0 ;
		 var TskProccessCount = 0 ;
		 var TskLateCount = 0 ;
  
  var url ="http://ws.evara.info/api/values/GetAllEntities";
  $.getJSON(url,function(result){ 
        //console.log(result);
 $.each(result, function(i , Ent){
	 
	   var url ="http://ws.evara.info/api/values/GetAllTasks";
  $.getJSON(url,function(result){ 
  
 TskSuccessCount = 0 ;
	TskNotStartedCount = 0 ;
	TskProccessCount = 0 ;
	TskLateCount = 0 ;
        //console.log(result);
 $.each(result, function(i , Tsk){
  
	 /*var Ent.ID = EntID ;
	 var Tsk.TypeEntityID = TskID ;*/
	 
	
	 if( Ent.ID == Tsk.TypeEntityID ){
		 
		 if(Tsk.TaskStatusID == 4) { TskSuccessCount++; }
		 if(Tsk.TaskStatusID == 3) { TskNotStartedCount++; }
		 if(Tsk.TaskStatusID == 2) { TskProccessCount++; }
		 if(Tsk.TaskStatusID == 1) { TskLateCount++; }
		 		 
	      }
		  
	  });
	  
	  //alert(TskSuccessCount);
	  
	  var AllTskCount = TskSuccessCount + TskNotStartedCount + TskProccessCount + TskLateCount  ;
	 
	 var TskSuccessPrcntg = (TskSuccessCount / AllTskCount) * 100  ;
	 var TskNotStartedPrcntg = (TskNotStartedCount / AllTskCount )  * 100 ;
	 var TskProccessPrcntg = (TskProccessCount / AllTskCount )  * 100  ;
	 var TskLatePrcntg = (TskLateCount / AllTskCount )  * 100 ;
	 
	 if( TskSuccessCount == 0) { TskSuccessPrcntg = 1 };
	 if( TskNotStartedCount == 0) { TskNotStartedPrcntg = 1 };
	 if( TskProccessCount == 0) { TskProccessPrcntg = 1 };
	 if( TskLateCount == 0) { TskLatePrcntg = 1 };
	 
	 
$(".entities").append('<div class="col-6 chart_box"><div class="item-container"><div class="item-title"><span>'+Ent.Name+'<span class="num">'+AllTskCount+'</span></div><!--item-title--><div class="chart"><ul><li class="task_success viewed"><p style="height: '+TskSuccessPrcntg+'%"><span>'+TskSuccessCount+'</span></p></li><li class="task_no_started viewed"><p style="height: '+TskNotStartedPrcntg+'%"><span>'+TskNotStartedCount+'</span></p></li><li class="task_inprogress viewed"><p style="height: '+TskProccessPrcntg+'%"><span>'+TskProccessCount+'</span></p></li><li class="task_late viewed"><p style="height: '+TskLatePrcntg+'%"><span>'+TskLateCount+'</span></p></li></ul></div><!--chart--></div></div><!--col-6-->');

}); 
 
 
 });

});






  var url ="http://ws.evara.info/api/values/GetAllClassification";
  $.getJSON(url,function(result){ 
        //console.log(result);
 $.each(result, function(i , Ent){
	 
	   var url ="http://ws.evara.info/api/values/GetAllTasks";
  $.getJSON(url,function(result){ 
  
 TskSuccessCount = 0 ;
	TskNotStartedCount = 0 ;
	TskProccessCount = 0 ;
	TskLateCount = 0 ;
        //console.log(result);
 $.each(result, function(i , Tsk){
  
	 /*var Ent.ID = EntID ;
	 var Tsk.TypeEntityID = TskID ;*/
	 
	
	 if( Ent.ID == Tsk.TypeEntityID ){
		 
		 if(Tsk.TaskStatusID == 4) { TskSuccessCount++; }
		 if(Tsk.TaskStatusID == 3) { TskNotStartedCount++; }
		 if(Tsk.TaskStatusID == 2) { TskProccessCount++; }
		 if(Tsk.TaskStatusID == 1) { TskLateCount++; }
		 		 
	      }
		  
	  });
	  
	  //alert(TskSuccessCount);
	  
	  var AllTskCount = TskSuccessCount + TskNotStartedCount + TskProccessCount + TskLateCount  ;
	 
	 var TskSuccessPrcntg = (TskSuccessCount / AllTskCount) * 100  ;
	 var TskNotStartedPrcntg = (TskNotStartedCount / AllTskCount )  * 100 ;
	 var TskProccessPrcntg = (TskProccessCount / AllTskCount )  * 100  ;
	 var TskLatePrcntg = (TskLateCount / AllTskCount )  * 100 ;
	 
	 if( TskSuccessCount == 0) { TskSuccessPrcntg = 1 };
	 if( TskNotStartedCount == 0) { TskNotStartedPrcntg = 1 };
	 if( TskProccessCount == 0) { TskProccessPrcntg = 1 };
	 if( TskLateCount == 0) { TskLatePrcntg = 1 };
	 
	 
$(".classification").append('<div class="col-6 chart_box"><div class="item-container"><div class="item-title"><span>'+Ent.Name+'<span class="num">'+AllTskCount+'</span></div><!--item-title--><div class="chart"><ul><li class="task_success viewed"><p style="height: '+TskSuccessPrcntg+'%"><span>'+TskSuccessCount+'</span></p></li><li class="task_no_started viewed"><p style="height: '+TskNotStartedPrcntg+'%"><span>'+TskNotStartedCount+'</span></p></li><li class="task_inprogress viewed"><p style="height: '+TskProccessPrcntg+'%"><span>'+TskProccessCount+'</span></p></li><li class="task_late viewed"><p style="height: '+TskLatePrcntg+'%"><span>'+TskLateCount+'</span></p></li></ul></div><!--chart--></div></div><!--col-6-->');

}); 
 
 
 });

});



var Mnum = "0" ;


function check_first_click(Class_is){ 

//alert(Mnum);

	/*if(Mnum == "0") {
		
		alert(Mnum);
		
		 Mnum = "1" ;
	

	  
	  $(".task_late p").css({"height":"10px !important"});
	  
	  $(".task_late").removeClass('viewed');
	  
	  		

	  
	   } 
	   
	   else{ 
	   
	   		alert(Mnum);

	   
	    Mnum = "0" ; 
	   
	    $(Class_is).show();  $(Class_is).addClass('viewed'); 
 }*/





}


var num_chart = 0 ;

function check_first_click_charts(){ 

	if(num_chart == 0) { num_chart = 1 ;  $(".chart_box").hide(); } 



//alert(num);

}


function sum_tasks(num_is){

		

	var sum = 0;

    $('.'+num_is+' .chart ul li span').each(function() {

		//alert($(this).html());

        sum += Number($(this).html());

    });

	//alert(sum);

	$('.'+num_is+' .num').html(sum);

	

}




function sum_tasks_by_task() {

	
		


 $(".chart_box").each(function(){

	var sum = 0;

 

	 $(this).find('ul li.viewed span').each(function() {

		 //alert("YES");

  sum += +$(this).text()||0;
  

});



$(this).find(".num").text(sum);

//alert(sum);


    });
	
	

 }



$("#task_late").click(function(){

	//check_first_click("task_late");

	check_first_click();


	$(this).toggleClass("dactive_link");
    $(".task_late").toggleClass('viewed');
    $(".task_late").toggle();

	
	
	sum_tasks_by_task();

});


$("#task_inprogress").click(function(){

	check_first_click();

	$(this).toggleClass("dactive_link");

    $(".task_inprogress").toggleClass('viewed');

    $(".task_inprogress").toggle();

	sum_tasks_by_task();

});





$("#task_no_started").click(function(){

	check_first_click()

	$(this).toggleClass("dactive_link");

    $(".task_no_started").toggleClass('viewed');

    $(".task_no_started").toggle();

	sum_tasks_by_task();

});



$("#task_success").click(function(){

	check_first_click();

	$(this).toggleClass("dactive_link");

    $(".task_success").toggleClass('viewed');

    $(".task_success").toggle();

	sum_tasks_by_task();

});



});

			
		</script>

    </body>
</html>
